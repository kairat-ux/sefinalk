# Сделанные изменения

## 1. Удалены тестовые данные из миграций ✅

- **Файл**: `src/main/resources/db/changelog/migrations/014-insert-base-data-NEW.xml`
- **Изменение**: Удалены все тестовые пользователи и рестораны
- **Причина**: Все данные теперь создаются через UI приложения

## 2. Создана страница добавления ресторана ✅

### Frontend
- **Новые файлы**:
  - `frontend/src/pages/owner/AddRestaurant.jsx` - форма добавления ресторана
  - `frontend/src/pages/owner/AddRestaurant.css` - стили для формы

### Функционал
- Валидация всех полей формы
- Проверка формата email и телефона
- Красивый адаптивный дизайн
- Отображение ошибок валидации в реальном времени

### Роут
- Добавлен роут `/owner/restaurants/add` для страницы добавления
- Доступен только для пользователей с ролью OWNER и ADMIN

## 3. Обновлена страница владельца ✅

- **Файл**: `frontend/src/pages/owner/OwnerDashboard.jsx`
- **Изменения**:
  - Обновлены ссылки с `/owner/restaurants/new` на `/owner/restaurants/add`
  - Добавлена кнопка "Add New Restaurant" в шапке страницы
  - Кнопка также отображается, когда у владельца нет ресторанов

## 4. Очищены временные файлы ✅

Удалены файлы, созданные для тестирования:
- `DevController.java` - временный контроллер для отладки
- `PasswordHashGenerator.java` - утилита для генерации хешей

## 5. Исправлены ошибки Liquibase ✅

- Изменен ID changeset с `014-insert-all-data-v3` на `014-insert-all-data-v4`
- Это решает проблему с checksum при изменении содержимого миграции

## Как использовать приложение

### Регистрация пользователей

1. **Создание админа**:
   ```bash
   POST http://localhost:8008/api/auth/register
   {
     "email": "admin@test.com",
     "password": "admin123",
     "firstName": "Admin",
     "lastName": "User",
     "phone": "+77001234567"
   }
   ```
   После регистрации нужно вручную изменить роль в базе данных на ADMIN.

2. **Создание владельца ресторана**:
   ```bash
   POST http://localhost:8008/api/auth/register
   {
     "email": "owner@test.com",
     "password": "owner123",
     "firstName": "Owner",
     "lastName": "User",
     "phone": "+77011234567"
   }
   ```
   После регистрации нужно вручную изменить роль в базе данных на OWNER.

3. **Создание обычного пользователя**:
   - Просто зарегистрируйтесь через UI (по умолчанию роль будет USER)

### Добавление ресторана

1. Войдите как пользователь с ролью OWNER или ADMIN
2. Перейдите в раздел "My Restaurants" (`/owner/restaurants`)
3. Нажмите кнопку "Add New Restaurant"
4. Заполните форму:
   - **Название ресторана** (обязательно)
   - **Описание** (обязательно)
   - **Адрес** (обязательно)
   - **Город** (обязательно)
   - **ZIP код** (обязательно)
   - **Телефон** (обязательно, формат: +7 777 123 4567)
   - **Email** (опционально)
5. Нажмите "Create Restaurant"

### Управление пользователями (Admin)

1. Войдите как ADMIN
2. Перейдите в `/admin/users`
3. Вы можете:
   - Просматривать всех пользователей
   - Искать по имени или email
   - Фильтровать по роли (USER, OWNER, ADMIN)
   - Блокировать/разблокировать пользователей
   - Удалять пользователей

## Структура проекта

```
frontend/
  src/
    pages/
      owner/
        AddRestaurant.jsx     # Новая страница для добавления ресторана
        AddRestaurant.css     # Стили для формы
        OwnerDashboard.jsx    # Обновлена (новые ссылки)
      admin/
        UsersManagement.jsx   # Управление пользователями
        RestaurantsManagement.jsx # Управление ресторанами
    App.jsx                   # Добавлен новый роут

backend/
  src/main/resources/db/changelog/migrations/
    014-insert-base-data-NEW.xml  # Очищен от тестовых данных
```

## Важные замечания

1. **Роли пользователей**: По умолчанию при регистрации создаются пользователи с ролью USER. Для создания ADMIN или OWNER нужно вручную обновить роль в базе данных.

2. **База данных**: При первом запуске база данных будет пустая - нужно создать пользователей и рестораны через UI.

3. **Liquibase**: При изменении существующих миграций нужно обновлять ID changeset, иначе Liquibase выдаст ошибку checksum.

## Следующие шаги

- Добавить возможность загрузки изображений для ресторанов
- Создать страницу редактирования ресторана
- Добавить управление столиками и рабочими часами
- Реализовать систему бронирования
